# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Gw9qG1YEC5oc4IJEg5s2QSGYNNBKOE6l
"""

!pip install flask-ngrok

import os

os.makedirs('/content/templates', exist_ok=True)

with open('/content/templates/form.html', 'w') as f:
    f.write("""
    <!DOCTYPE html>
    <html>
    <head><title>Form</title></head>
    <body>
        <h2>Enter something</h2>
        <form method="POST">
            <input type="text" name="input" />
            <button type="submit">Submit</button>
        </form>
    </body>
    </html>
    """)

!pip install pyngrok

from pyngrok import ngrok

from flask import Flask, render_template, request
from pyngrok import ngrok, conf
import numpy as np
import joblib

conf.get_default().auth_token = "309QUeFfVUcyRJAqb8I86BTIgR4_6NEHWbB7zVa4gT3K56Ww6"

app = Flask(__name__, template_folder='/content/templates')
model = joblib.load("final_model.pkl")

@app.route('/', methods=['GET', 'POST'])
def form():
    if request.method == 'POST':
        user_input = request.form['input']
        return f"You entered: {user_input}"
    return render_template('form.html')

def home():
    return render_template('form.html')

@app.route('/predict', methods=['POST'])
def predict():
    feature1 = float(request.form['feature1'])
    feature2 = float(request.form['feature2'])
    input_data = np.array([[feature1, feature2]])
    prediction = model.predict(input_data)
    return render_template('form.html', prediction_text=f"Estimated Salary: ${prediction[0]:,.2f}")


public_url = ngrok.connect(5000)
print("Public URL:", public_url)

app.run()